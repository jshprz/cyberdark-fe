import { Component } from '@angular/core';
import { DataTableComponent } from '../../shared/components/table/data-table/data-table.component';
import { TableToolbarComponent } from '../../shared/components/table/table-toolbar/table-toolbar.component';

type VulnerabilityRecord = {
  vulnerability: string;
  severity: number;
  host_ip: string;
  name: string;
  location: string;
};

@Component({
  selector: 'app-vulnerability-scans',
  imports: [DataTableComponent, TableToolbarComponent],
  templateUrl: './vulnerability-scans.component.html',
  styleUrl: './vulnerability-scans.component.css',
})
export class VulnerabilityScansComponent {
  readonly vulnerabilityColumns: { header: string; accessor: keyof VulnerabilityRecord }[] = [
    { header: 'VULNERABILITY', accessor: 'vulnerability' },
    { header: 'SEVERITY', accessor: 'severity' },
    { header: 'HOST IP', accessor: 'host_ip' },
    { header: 'NAME', accessor: 'name' },
    { header: 'LOCATION', accessor: 'location' },
  ];

  readonly vulnerabilityData: VulnerabilityRecord[] = [
    {
      vulnerability: 'Operating System (OS) End of Life (EOL) Detection',
      severity: 10.0,
      host_ip: '109.226.xxx.xxx',
      name: 'http://gxxx.co.il',
      location: 'general/tcp',
    },
    {
      vulnerability: "Microsoft Windows RDP 'CVE-2019-0708' (BlueKeep) - Remote Active",
      severity: 9.8,
      host_ip: '82.81.xxx.xxx',
      name: 'admin-portal.gxxx.co.il',
      location: '5120/tcp',
    },
    {
      vulnerability: 'Open RDP Port',
      severity: 9.0,
      host_ip: '82.81.xxx.xxx',
      name: 'vpn.gxxx.co.il',
      location: '5162/tcp',
    },
    {
      vulnerability: 'Open SQL Server Port',
      severity: 9.0,
      host_ip: '82.81.xxx.xxx',
      name: 'server-db.gxxx.co.il',
      location: '1433/tcp',
    },
    {
      vulnerability: 'SSL/TLS: Report Vulnerable Cipher Suites for HTTPS',
      severity: 7.5,
      host_ip: '37.19.xxx.xxx',
      name: 'secure.gxxx.org.il',
      location: '443/tcp',
    },
  ];
}
